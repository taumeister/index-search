services:
  web:
    build: .
    container_name: index-search-web
    user: "0:0"
    ports:
      - "8010:8000"
    volumes:
      - ./:/app
      - ${DATA_ROOT:-/storage/unimatrix/}:/data:ro
    environment:
      - TZ=${TZ:-Europe/Berlin}
      - APP_SECRET=${APP_SECRET}
      - INDEX_ROOTS=${INDEX_ROOTS:-/data/}
      - INDEX_WORKER_COUNT=${INDEX_WORKER_COUNT:-2}
      - INDEX_MAX_FILE_SIZE_MB=${INDEX_MAX_FILE_SIZE_MB:-0}
      - LOG_LEVEL=${LOG_LEVEL:-INFO}
      - LOG_DIR=${LOG_DIR:-logs}
      - LOG_ROTATION_MB=${LOG_ROTATION_MB:-10}
      - SMTP_HOST=${SMTP_HOST:-}
      - SMTP_PORT=${SMTP_PORT:-587}
      - SMTP_USE_TLS=${SMTP_USE_TLS:-true}
      - SMTP_USER=${SMTP_USER:-}
      - SMTP_PASS=${SMTP_PASS:-}
      - SMTP_FROM=${SMTP_FROM:-index-search@localhost}
      - SMTP_TO=${SMTP_TO:-}
      - SEND_REPORT_ENABLED=${SEND_REPORT_ENABLED:-0}
    restart: unless-stopped
